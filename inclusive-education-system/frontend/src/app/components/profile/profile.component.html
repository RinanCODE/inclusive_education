<div class="profile-page">
  <!-- Page Header -->
  <div class="page-header-section">
    <div class="header-content">
      <h1 class="page-title">My Profile</h1>
      <p class="page-subtitle">Manage your account information and preferences</p>
    </div>
    <div class="header-actions">
      <button class="btn btn-primary" (click)="toggleEditMode()">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
          <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
        </svg>
        {{ isEditMode ? 'Cancel' : 'Edit Profile' }}
      </button>
    </div>
  </div>

  <!-- Profile Content -->
  <div class="content-section">
    <!-- Profile Info Card -->
    <div class="section-card profile-info-card">
      <div class="profile-header">
        <div class="profile-avatar-large">
          <span>{{ getUserInitials() }}</span>
        </div>
        <div class="profile-info">
          <h2>{{ currentUser?.name }}</h2>
          <p class="user-role">{{ getRoleDisplay() }}</p>
          <p class="user-email">{{ currentUser?.email }}</p>
        </div>
      </div>
    </div>

    <!-- Personal Information -->
    <div class="section-card">
      <div class="section-header">
        <h2>Personal Information</h2>
      </div>
      <form class="profile-form">
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Full Name</label>
            <input 
              type="text" 
              class="form-control" 
              [value]="currentUser?.name" 
              [disabled]="!isEditMode"
              placeholder="Enter your full name">
          </div>
          <div class="form-group">
            <label class="form-label">Email Address</label>
            <input 
              type="email" 
              class="form-control" 
              [value]="currentUser?.email" 
              [disabled]="!isEditMode"
              placeholder="Enter your email">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Phone Number</label>
            <input 
              type="tel" 
              class="form-control" 
              value="+1 (555) 123-4567" 
              [disabled]="!isEditMode"
              placeholder="Enter your phone number">
          </div>
          <div class="form-group">
            <label class="form-label">Date of Birth</label>
            <input 
              type="date" 
              class="form-control" 
              value="2000-01-15" 
              [disabled]="!isEditMode">
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Academic Background</label>
          <textarea 
            class="form-control" 
            rows="3" 
            [disabled]="!isEditMode"
            placeholder="E.g., STEM focus, prior courses"
            [(ngModel)]="profile.academic_background" name="academic_background"></textarea>
        </div>

        <div class="form-group">
          <label class="form-label">Learning Goals</label>
          <textarea 
            class="form-control" 
            rows="3" 
            [disabled]="!isEditMode"
            placeholder="E.g., prepare for exams, improve math"
            [(ngModel)]="profile.learning_goals" name="learning_goals"></textarea>
        </div>

        <div class="form-group">
          <label class="form-label">Accessibility Needs</label>
          <input 
            type="text" 
            class="form-control" 
            [disabled]="!isEditMode"
            placeholder="E.g., large text, captions"
            [(ngModel)]="profile.accessibility_needs" name="accessibility_needs" />
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Preference: Learning Style</label>
            <select class="form-control" [disabled]="!isEditMode" [(ngModel)]="profilePrefStyle" name="pref_style">
              <option value="">Select style</option>
              <option value="visual">Visual</option>
              <option value="reading">Reading</option>
              <option value="interactive">Interactive</option>
              <option value="auditory">Auditory</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Preference: Pace</label>
            <select class="form-control" [disabled]="!isEditMode" [(ngModel)]="profilePrefPace" name="pref_pace">
              <option value="">Select pace</option>
              <option value="slow">Slow</option>
              <option value="normal">Normal</option>
              <option value="fast">Fast</option>
            </select>
          </div>
        </div>

        <div class="form-actions" *ngIf="isEditMode">
          <button type="button" class="btn btn-outline" (click)="toggleEditMode()">Cancel</button>
          <button type="submit" class="btn btn-primary" (click)="saveProfile($event)">Save Changes</button>
        </div>
      </form>
    </div>

    <!-- Account Statistics -->
    <div class="section-card stats-card" *ngIf="currentUser?.role === 'student'">
      <div class="section-header">
        <h2>Account Statistics</h2>
      </div>
      <div class="stats-grid">
        <div class="stat-item">
          <div class="stat-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
              <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
            </svg>
          </div>
          <div class="stat-content">
            <span class="stat-value">12</span>
            <span class="stat-label">Courses Enrolled</span>
          </div>
        </div>
        <div class="stat-item">
          <div class="stat-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
              <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>
          </div>
          <div class="stat-content">
            <span class="stat-value">8</span>
            <span class="stat-label">Completed</span>
          </div>
        </div>
        <div class="stat-item">
          <div class="stat-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
          </div>
          <div class="stat-content">
            <span class="stat-value">156</span>
            <span class="stat-label">Hours Learned</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Change Password -->
    <div class="section-card">
      <div class="section-header">
        <h2>Change Password</h2>
      </div>
      <form class="profile-form">
        <div class="form-group">
          <label class="form-label">Current Password</label>
          <input type="password" class="form-control" placeholder="Enter current password">
        </div>
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">New Password</label>
            <input type="password" class="form-control" placeholder="Enter new password">
          </div>
          <div class="form-group">
            <label class="form-label">Confirm New Password</label>
            <input type="password" class="form-control" placeholder="Confirm new password">
          </div>
        </div>
        <div class="form-actions">
          <button type="submit" class="btn btn-primary">Update Password</button>
        </div>
      </form>
    </div>

    <!-- Subject Confidence -->
    <div class="section-card">
      <div class="section-header">
        <h2>Subject Confidence</h2>
      </div>
      <form class="profile-form" (submit)="submitConfidence($event)">
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Subject</label>
            <input type="text" class="form-control" placeholder="e.g., Math" [(ngModel)]="confidenceSubject" name="conf_subject" required />
          </div>
          <div class="form-group">
            <label class="form-label">Confidence (0-100)</label>
            <input type="number" class="form-control" min="0" max="100" [(ngModel)]="confidenceValue" name="conf_value" required />
          </div>
        </div>
        <div class="form-actions">
          <button type="submit" class="btn btn-primary">Save Confidence</button>
        </div>
      </form>
    </div>
  </div>
</div>
